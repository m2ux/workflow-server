id: test-plan
version: 1.0.0
title: Test Plan Creation Guide
purpose: Guidelines for creating well-structured test plans that document test cases, traceability, and validation criteria for work packages

sections[10]:
  - id: overview
    title: Overview
    content: """
      Test plans are lightweight documents that accompany ADRs and PRs, providing structured documentation of how changes will be validated. They bridge the gap between design decisions and implementation verification.

      > **Key Insight:** Test plans document *what* will be tested and *why*, with direct traceability to source code. They serve as both verification artifacts and living documentation.
    """
    complementsADR[4]{adrDocuments,testPlanDocuments}:
      What was decided and why,How decisions are validated
      Requirements and constraints,Test cases that verify requirements
      Trade-offs between options,Expected behaviors and edge cases
      Design rationale,Traceability to implementation

  - id: when-to-write
    title: When to Write a Test Plan
    writeWhen[5]:
      - Implementing a feature with multiple testable behaviors
      - Making changes that require regression testing
      - "The ADR has specific 'Confirmation' criteria to validate"
      - Complex logic requires documented test coverage
      - Changes affect multiple components or systems
    skipWhen[4]:
      - Simple bug fix with obvious test case
      - Documentation-only changes
      - Single test adequately covers the change
      - Refactoring with existing test coverage

  - id: tdd-principles
    title: TDD Principles for Test Design
    principles[5]{principle,description,application}:
      Test List,Plan tests before implementation,List all test objectives in the initial test plan
      0-1-N Pattern,"Test zero, one, and many cases","Include empty, single, and multiple item scenarios"
      Boundary Values,Test edges and limits,"Cover min/max values, empty inputs, edge cases"
      Four-Phase Test,Arrange-Act-Assert structure,"Structure each test case with clear setup, action, verification"
      FIRST Principles,"Fast, Independent, Repeatable, Self-validating, Timely",Design tests that run quickly and independently
    testCategories[5]:
      - "**Happy Path** - Normal, expected behavior"
      - "**Edge Cases** - Boundary conditions and limits"
      - "**Error Handling** - Invalid inputs, failure scenarios"
      - "**State Transitions** - Changes between valid states"
      - "**Integration Points** - Component interactions"

  - id: lifecycle
    title: Test Plan Lifecycle
    phases[2]:
      - id: initial
        name: "Phase 1: Initial Placeholder (At PR Creation)"
        includes[4]:
          - Header with ADR/Ticket/PR links
          - Overview describing what will be validated
          - Planned test cases (objectives only, no source links)
          - Empty or placeholder Running Tests section
        excludes[3]:
          - "Hyperlinks to source code (tests don't exist yet)"
          - Specific line numbers
          - Detailed steps (implementation-dependent)

      - id: final
        name: "Phase 2: Final Test Plan (After Implementation)"
        includes[4]:
          - Hyperlinked Test IDs pointing to actual test locations
          - Detailed steps reflecting actual test implementation
          - Verified Running Tests commands
          - Hyperlinked symbols in Overview
    templates:
      initial: workflow://work-package/templates/04
      final: workflow://work-package/templates/05

  - id: structure
    title: Test Plan Structure
    requiredSections[4]:
      - "**Header and Links** - ADR, Ticket, PR references"
      - "**Overview** - Brief description with hyperlinked symbols"
      - "**Test Cases** - Table with Test ID, Objective, Steps, Expected Result, Type"
      - "**Running Tests** - Commands to execute tests"

  - id: test-case-table
    title: Test Case Table Guidelines
    columns[5]:
      - "**Test ID** - Hyperlinked to source (e.g., `[PR###-TC-01](../../path/to/test.rs#LNN)`)"
      - "**Objective** - What behavior is being verified"
      - "**Steps** - Setup and actions (use `  <br>` for line breaks)"
      - "**Expected Result** - Observable outcome"
      - "**Type** - Unit, Integration, E2E, Performance, or Manual"
    testIdFormat: "PR<number>-TC-<sequence>"
    testTypes[5]{type,description,when}:
      Unit,Tests isolated component behavior,Single function/method testing
      Integration,Tests component interactions,Multiple components working together
      E2E,Tests complete user workflows,Full system behavior
      Performance,Validates performance criteria,"Latency, throughput requirements"
      Manual,Tests requiring human execution,"RPC endpoints, network behavior, UI verification"

  - id: running-tests
    title: Running Tests Section
    content: "Provide commands to execute the tests documented in the plan. Include commands for different scopes: all tests, module-specific, and individual tests."

  - id: quality-checklist
    title: Quality Checklist
    items[8]:
      - Test plan links to ADR and ticket
      - Overview describes what's being tested
      - Test IDs follow PR###-TC-## pattern
      - All Test IDs hyperlink to source code
      - Steps use proper line break formatting
      - Running Tests includes all scope levels
      - Manual tests are clearly marked
      - Temporarily disabled tests are annotated with **

  - id: anti-patterns
    title: Anti-Patterns
    patterns[5]{dont,why}:
      Reference non-existent source,Links must point to actual implemented tests
      Use vague objectives,"'Test the function' vs 'Verify empty input returns error'"
      Skip type classification,Unclear what test scope is being covered
      Omit running instructions,Reviewers need to verify tests pass
      Separate tables by type,Keep all tests in a unified table for visibility

  - id: related-guides
    title: Related Guides
    guides[3]:
      - workflow://work-package/guides/architecture-review
      - workflow://work-package/guides/complete
      - workflow://work-package/guides/task-completion-review
