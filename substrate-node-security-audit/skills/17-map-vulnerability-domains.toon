id: map-vulnerability-domains
version: 2.0.0
capability: "Bind architectural analysis artifacts to §3 verification procedures, producing a structured domain map partitioned by crate"

description: "A mechanical binding skill that connects security-relevant architectural properties (from the sub-architectural-analysis agent) to the corresponding §3 checklist verification procedures. Does NOT perform reasoning — that was done by the architecture sub-agent. This skill maps each interaction model entry, privilege map entry, and emergent domain to the §3 item(s) that verify it, then partitions the result by crate for sub-agent distribution."

inputs[6]:
  - id: interaction-model
    description: "Component interaction model with trust assumptions and security properties (from sub-architectural-analysis)"
    required: true
  - id: privilege-map
    description: "Privilege and authority map with verification points (from sub-architectural-analysis)"
    required: true
  - id: candidate-points
    description: "Ranked candidate point list (from sub-architectural-analysis)"
    required: true
  - id: emergent-domains
    description: "Vulnerability domains not covered by §3 (from sub-architectural-analysis)"
    required: false
  - id: crate-map
    description: "Classification of crates by category and priority (from reconnaissance)"
    required: true
  - id: target-profile
    description: "Resource 06 — target-specific domain hints to supplement architectural analysis"
    required: false

protocol:
  bind-interactions-to-checklist[1]:
    - "For each component interaction, match the required security property to the §3 item that verifies it. Mapping rules: data consistency across boundaries → §3.2; partial-success event paths → §3.3; asymmetric provider sets → §3.4; genesis state sources → §3.5; unvalidated external input → §3.6; shared resources with mixed consumers → §3.8; cross-chain timestamp propagation → §3.10; typed enum dispatch → §3.14. Interactions with no matching §3 item are flagged as emergent domains."
  bind-privilege-to-checklist[1]:
    - "For each privilege entry, match to: weight/metering → §3.1; access control → §3.13; upgrade safety → §3.12; genesis consistency → §3.5. Entries where authority verification is absent or inconsistent become priority review targets."
  incorporate-emergent-domains[1]:
    - "For each emergent domain (from sub-architectural-analysis or from interactions with no §3 match), create an ad-hoc review entry with: domain description, affected components, suggested verification approach. These are distributed to the relevant Group A agents as additional review items beyond §3."
  partition-by-crate[1]:
    - "Group all domain map entries by crate. Each crate's partition includes: §3 entries with specific locations and verification targets, candidate points ranked by security relevance, and any ad-hoc emergent domain review items. Merge with target profile domain hints if available."

output[1]:
  - id: domain-map
    description: "Structured domain map partitioned by crate, ready for sub-agent distribution."
    components:
      per_crate_domain_entries: "§3 domain entries: vulnerability_class, location, security_property, verification_target"
      per_crate_candidate_points: "location, complexity_reason, trust_boundary_proximity"
      per_crate_emergent_domains: "domain_description, affected_components, suggested_verification"
