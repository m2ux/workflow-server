# Vulnerability Pattern Vocabulary

Patterns that the architectural analysis sub-agent should recognize when building the interaction model and identifying emergent domains. Each pattern describes a structural condition and its security consequence. Derived from cross-project analysis of 22 professional Substrate audit reports.

## V1: Zero-Value Operation State Reset

When an operation accepts a user-controlled amount and has side-effects (index resets, timestamp updates, snapshot overwrites) that fire regardless of the amount's magnitude, a zero-value invocation triggers the side-effects without the primary operation. FINDING if: any accumulator/index/snapshot is overwritten in a code path reachable with amount=0.

## V4: Create/Update Validation Divergence

When separate functions create and update the same entity, validation enforced at creation may be absent from the update path. FINDING if: any ensure!/require! in a create function has no counterpart in the corresponding update function for the same entity.

**Extension — Immutable Erroneous State (No Correction Path):** The more severe variant: no update or correction function exists at all. Once an entity is created with incorrect parameters (wrong decimals, wrong address, wrong metadata), the state is permanently wrong. FINDING if: an entity-creation extrinsic callable by non-root users has no corresponding update, correction, or removal mechanism. (Source: Fusotao/SlowMist — `issue()` creates tokens with user-supplied parameters but no `update_token` exists.)

## V6: Self-Referential Operation Missing Guard

When a function operates on two account-id parameters (sender/receiver, voter/candidate, challenger/challengee), the parameters may be identical. FINDING if: a two-party operation modifies balances/shares/votes without ensure!(party_a != party_b).

## V9: Checks-Effects Ordering Violation

When storage mutations (nonce increment, ledger update, balance write) occur before all validation guards complete, a failed late guard leaves mutated state. FINDING if: any storage write precedes the last ensure!/validation check in the same extrinsic.

## V10: Aggregate Counter Desync

When a child record (StorageMap entry) is inserted or removed but the corresponding parent aggregate (TotalX StorageValue) is not updated, the aggregate becomes inconsistent. FINDING if: any StorageMap mutation is not paired with a corresponding aggregate update.

## V13: Reward Inflation via Rounding at Low Liquidity

When reward-per-share calculations use integer division with a denominator that can be very small, the quotient rounds to zero, enabling free reward claims. FINDING if: any share-proportional reward uses integer division without minimum-liquidity thresholds or round-up for debt.
